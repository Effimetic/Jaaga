{% extends "base.html" %}

{% block title %}{% if edit_mode %}Edit Schedule{% else %}Schedule Options - Step 5{% endif %}{% endblock %}

{% block content %}
<div class="mobile-app-container">
  <div class="page-header">
    <div class="header-content">
      <h4 class="page-title"><i class="fas fa-{% if edit_mode %}edit{% else %}cog{% endif %} me-2"></i>{% if edit_mode %}Edit Schedule{% else %}Schedule Options{% endif %}</h4>
      <p class="page-subtitle">{% if edit_mode %}Update schedule configuration{% else %}Final step • Review and create{% endif %}
    </div>
    <a href="{% if edit_mode %}{{ url_for('scheduling.view_schedule', schedule_id=edit_schedule_id) }}{% else %}{{ url_for('scheduling.set_destinations') }}{% endif %}" class="add-btn" title="Back"><i class="fas fa-arrow-left"></i></a>
  </div>

  <div class="form-card">
    <form id="scheduleOptionsForm">
        <!-- Hidden fields for edit mode -->
        <input type="hidden" id="editMode" value="{{ 'true' if edit_mode else 'false' }}">
        <input type="hidden" id="editScheduleId" value="{{ edit_schedule_id or '' }}">
        <input type="hidden" id="publicTicketTypeIds" value="{{ (public_ticket_type_ids or [])|tojson }}">
        <input type="hidden" id="agentTicketTypeIds" value="{{ (agent_ticket_type_ids or [])|tojson }}">
        <input type="hidden" id="taxProfileId" value="{{ tax_profile_id or '' }}">
                        <!-- Save as Template -->
                        <div class="mb-4">
                            <div class="card border-info">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <i class="fas fa-save me-2"></i>Save as Template
                                    </h5>
                                    <p class="text-muted">Save this schedule configuration as a template for future use</p>
                                    
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="saveAsTemplate" name="save_as_template">
                                        <label class="form-check-label" for="saveAsTemplate">
                                            Save as reusable template
                                        </label>
                                    </div>
                                    
                                    <div id="templateNameSection" style="display: none;" class="mt-3">
                                        <label for="templateName" class="form-label">Template Name</label>
                                        <input type="text" class="form-control" id="templateName" name="template_name" 
                                               placeholder="e.g., Daily Male Route">
                                        <div class="form-text">Give your template a descriptive name</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Schedule Repetition -->
                        <div class="mb-4">
                            <div class="card border-warning">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <i class="fas fa-calendar-plus me-2"></i>Schedule Repetition
                                    </h5>
                                    <p class="text-muted">Create multiple schedules based on this configuration</p>
                                    
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="repeatSchedule" name="repeat_schedule">
                                        <label class="form-check-label" for="repeatSchedule">
                                            Create additional schedules on selected dates
                                        </label>
                                    </div>
                                    
                                    <div id="calendarSection" style="display: none;">
                                        <div class="calendar-container">
                                            <div class="calendar-header">
                                                <button type="button" class="btn btn-sm btn-outline-secondary" id="prevMonth">
                                                    <i class="fas fa-chevron-left"></i>
                                                </button>
                                                <h6 class="mb-0" id="currentMonth">August 2025</h6>
                                                <button type="button" class="btn btn-sm btn-outline-secondary" id="nextMonth">
                                                    <i class="fas fa-chevron-right"></i>
                                                </button>
                                            </div>
                                            <div class="calendar-grid">
                                                <div class="calendar-weekdays">
                                                    <div>Sun</div>
                                                    <div>Mon</div>
                                                    <div>Tue</div>
                                                    <div>Wed</div>
                                                    <div>Thu</div>
                                                    <div>Fri</div>
                                                    <div>Sat</div>
                                                </div>
                                                <div class="calendar-days" id="calendarDays">
                                                    <!-- Calendar days will be populated by JavaScript -->
                                                </div>
                                            </div>
                                            <div class="mt-2">
                                                <small class="text-muted">
                                                    <i class="fas fa-info-circle me-1"></i>
                                                    Click on dates to select/deselect. Past dates cannot be selected.
                                                </small>
                                            </div>
                                            <input type="hidden" id="selectedDates" name="selected_dates" value="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Booking Configuration -->
                        <div class="mb-4">
                            <div class="card border-info">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <i class="fas fa-cog me-2"></i>Booking Configuration
                                    </h5>
                                    <p class="text-muted">Configure booking behavior and visibility</p>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="confirmationType" class="form-label">Booking Confirmation</label>
                                            <select class="form-select" id="confirmationType" name="confirmation_type">
                                                <option value="immediate">Immediate Confirmation</option>
                                                <option value="manual">Manual Booking Confirmation</option>
                                            </select>
                                            <div class="form-text">
                                                <strong>Immediate:</strong> Bookings are confirmed instantly<br>
                                                <strong>Manual:</strong> Bookings require owner approval
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="isPublic" class="form-label">Public Visibility</label>
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox" id="isPublic" name="is_public" checked>
                                                <label class="form-check-label" for="isPublic">
                                                    Show this schedule to the public
                                                </label>
                                            </div>
                                            <div class="form-text">
                                                Uncheck to hide from public booking interface
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ticket Types & Tax Configuration -->
                        <div class="mb-4">
                            <div class="card border-primary">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <i class="fas fa-ticket-alt me-2"></i>Ticket Types & Pricing
                                    </h5>
                                    <p class="text-muted">Select ticket types and tax profile for this schedule. <strong>Currency is automatically set from each ticket type.</strong></p>
                                    
                                                                         <!-- Public Ticket Types Selection -->
                                     <div class="mb-3">
                                         <label class="form-label">Public Ticket Types</label>
                                         <div id="publicTicketTypesContainer">
                                             <div class="text-center py-3">
                                                 <i class="fas fa-spinner fa-spin fa-2x text-muted"></i>
                                                 <p class="text-muted mt-2">Loading ticket types...</p>
                                             </div>
                                         </div>
                                         <div class="form-text">
                                             <i class="fas fa-globe me-1"></i>
                                             Select ticket types available for public bookings
                                         </div>
                                     </div>
                                     
                                     <!-- Agent Ticket Types Selection -->
                                     <div class="mb-3">
                                         <label class="form-label">Agent Ticket Types</label>
                                         <div id="agentTicketTypesContainer">
                                             <div class="text-center py-3">
                                                 <i class="fas fa-spinner fa-spin fa-2x text-muted"></i>
                                                 <p class="text-muted mt-2">Loading ticket types...</p>
                                             </div>
                                         </div>
                                         <div class="form-text">
                                             <i class="fas fa-user-tie me-1"></i>
                                             Select ticket types available for agent bookings
                                         </div>
                                     </div>
                                    
                                    <!-- Tax Profile Selection -->
                                    <div class="mb-3">
                                        <label for="taxProfile" class="form-label">Tax Profile</label>
                                        <select class="form-select" id="taxProfile" name="tax_profile_id">
                                            <option value="">No taxes</option>
                                            <div id="taxProfilesContainer">
                                                <!-- Tax profiles will be loaded here -->
                                            </div>
                                        </select>
                                        <div class="form-text">
                                            <i class="fas fa-info-circle me-1"></i>
                                            Choose how taxes will be calculated for this schedule
                                        </div>
                                    </div>
                                    
                                                                         <!-- Ticket Types Preview -->
                                     <div id="ticketTypesPreview" class="mt-3" style="display: none;">
                                         <div class="alert alert-info">
                                             <h6 class="mb-2"><i class="fas fa-ticket-alt me-2"></i>Selected Ticket Types</h6>
                                             <div id="ticketTypesPreviewContent">
                                                 <!-- Selected ticket types will be shown here -->
                                             </div>
                                         </div>
                                     </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Schedule Summary -->
                        <div class="mb-4">
                            <div class="card border-success">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <i class="fas fa-list me-2"></i>Schedule Summary
                                    </h5>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <p class="mb-1"><strong>Schedule Name:</strong> <span id="summaryName">{{ schedule_name }}</span></p>
                                            <p class="mb-1"><strong>Date:</strong> <span id="summaryDate">{{ schedule_date }}</span></p>
                                            <p class="mb-1"><strong>Boat:</strong> <span id="summaryBoat">{{ boat_name }}</span></p>
                                        </div>
                                        <div class="col-md-6">
                                            <p class="mb-1"><strong>Total Seats:</strong> <span id="summarySeats">{{ total_seats }}</span></p>
                                            <p class="mb-1"><strong>Blocked Seats:</strong> <span id="summaryBlocked">{{ blocked_count }}</span></p>
                                            <p class="mb-1"><strong>Destinations:</strong> <span id="summaryDestinations">{{ destination_count }}</span></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
      <div class="actions">
        <a href="{{ url_for('scheduling.set_destinations') }}" class="cancel-link"><i class="fas fa-arrow-left me-2"></i>Back to destinations</a>
        <button type="submit" class="submit-btn"><i class="fas fa-check me-2"></i>{% if edit_mode %}Update Schedule{% else %}Create schedule(s){% endif %}</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
            // Load ticket types and tax profiles
loadTicketTypes('public');
loadTicketTypes('agent');
loadTaxProfiles();

// Preload data if in edit mode
if (document.getElementById('editMode').value === 'true') {
    loadEditModeData();
}
    
    // Template name toggle
    document.getElementById('saveAsTemplate').addEventListener('change', function() {
        const templateSection = document.getElementById('templateNameSection');
        templateSection.style.display = this.checked ? 'block' : 'none';
    });
    
    // Calendar functionality
    let currentDate = new Date();
    let selectedDates = new Set();
    
    function renderCalendar(date) {
        const year = date.getFullYear();
        const month = date.getMonth();
        
        // Update header
        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                           'July', 'August', 'September', 'October', 'November', 'December'];
        document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;
        
        // Get first day of month and number of days
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const startDate = new Date(firstDay);
        startDate.setDate(startDate.getDate() - firstDay.getDay());
        
        const calendarDays = document.getElementById('calendarDays');
        calendarDays.innerHTML = '';
        
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        
        // Generate calendar days
        for (let i = 0; i < 42; i++) {
            const currentDay = new Date(startDate);
            currentDay.setDate(startDate.getDate() + i);
            
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            dayElement.textContent = currentDay.getDate();
            
            // Check if it's current month
            if (currentDay.getMonth() !== month) {
                dayElement.classList.add('other-month');
            }
            
            // Check if it's today
            if (currentDay.getTime() === today.getTime()) {
                dayElement.classList.add('today');
            }
            
            // Check if it's in the past
            if (currentDay < today) {
                dayElement.classList.add('disabled');
            } else {
                // Add click event for selectable dates
                dayElement.addEventListener('click', function() {
                    const dateString = currentDay.toISOString().split('T')[0];
                    if (selectedDates.has(dateString)) {
                        selectedDates.delete(dateString);
                        dayElement.classList.remove('selected');
                    } else {
                        selectedDates.add(dateString);
                        dayElement.classList.add('selected');
                    }
                    updateSelectedDatesInput();
                });
            }
            
            // Check if date is already selected
            const dateString = currentDay.toISOString().split('T')[0];
            if (selectedDates.has(dateString)) {
                dayElement.classList.add('selected');
            }
            
            calendarDays.appendChild(dayElement);
        }
    }
    
    function updateSelectedDatesInput() {
        document.getElementById('selectedDates').value = Array.from(selectedDates).join(',');
    }
    
    // Initialize calendar when repetition is enabled
    function initializeCalendar() {
        renderCalendar(currentDate);
        
        // Navigation buttons
        document.getElementById('prevMonth').addEventListener('click', function() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar(currentDate);
        });
        
        document.getElementById('nextMonth').addEventListener('click', function() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar(currentDate);
        });
    }
    
    // Repetition toggle and calendar initialization
    document.getElementById('repeatSchedule').addEventListener('change', function() {
        const calendarSection = document.getElementById('calendarSection');
        calendarSection.style.display = this.checked ? 'block' : 'none';
        
        if (this.checked) {
            // Small delay to ensure DOM is ready
            setTimeout(initializeCalendar, 100);
        }
    });
    
         // Load available ticket types for the current owner
     async function loadTicketTypes(channel) {
         try {
             const response = await fetch('/api/ticket-types');
             const data = await response.json();
             
             if (response.ok) {
                 renderTicketTypes(data.ticket_types, channel);
             } else {
                 showAlert('Failed to load ticket types', 'danger');
             }
         } catch (error) {
             console.error('Error loading ticket types:', error);
             showAlert('Failed to load ticket types', 'danger');
         }
     }
    
         // Render ticket types as checkboxes
     function renderTicketTypes(ticketTypes, channel) {
         const containerId = channel === 'public' ? 'publicTicketTypesContainer' : 'agentTicketTypesContainer';
         const container = document.getElementById(containerId);
         
         if (!ticketTypes || ticketTypes.length === 0) {
             container.innerHTML = `
                 <div class="alert alert-warning">
                     <i class="fas fa-exclamation-triangle me-2"></i>
                     No ticket types found. Please create ticket types in your settings first.
                     <a href="/owner/settings" class="btn btn-sm btn-outline-warning ms-2">Go to Settings</a>
                 </div>
             `;
             return;
         }
         
         const html = ticketTypes.map(type => `
             <div class="form-check mb-2">
                 <input class="form-check-input ${channel}-ticket-type-checkbox" type="checkbox" 
                        id="${channel}_ticket_type_${type.id}" value="${type.id}" 
                        data-name="${type.name}" data-price="${type.base_price}" data-currency="${type.currency}" data-code="${type.code}" data-channel="${channel}">
                 <label class="form-check-label" for="${channel}_ticket_type_${type.id}">
                     <strong>${type.name}</strong> (${type.code}) - 
                     <span class="badge bg-primary">${type.base_price} ${type.currency}</span>
                     ${type.refundable ? '<span class="badge bg-success ms-1">Refundable</span>' : '<span class="badge bg-secondary ms-1">Non-refundable</span>'}
                 </label>
             </div>
         `).join('');
         
         container.innerHTML = html;
         
         // Add event listeners for ticket types preview
         document.querySelectorAll(`.${channel}-ticket-type-checkbox`).forEach(checkbox => {
             checkbox.addEventListener('change', updateTicketTypesPreview);
         });
     }
    
    // Load available tax profiles for the current owner
    async function loadTaxProfiles() {
        try {
            const response = await fetch('/api/tax-profiles');
            const data = await response.json();
            
            if (response.ok) {
                renderTaxProfiles(data.tax_profiles);
            } else {
                showAlert('Failed to load tax profiles', 'danger');
            }
        } catch (error) {
            console.error('Error loading tax profiles:', error);
            showAlert('Failed to load tax profiles', 'danger');
        }
    }
    
    // Render tax profiles in dropdown
    function renderTaxProfiles(taxProfiles) {
        const container = document.getElementById('taxProfilesContainer');
        
        if (!taxProfiles || taxProfiles.length === 0) {
            container.innerHTML = '<option value="">No tax profiles available</option>';
            return;
        }
        
        const html = taxProfiles.map(profile => 
            `<option value="${profile.id}">${profile.name}</option>`
        ).join('');
        
        container.innerHTML = html;
        
                 // Add event listener for ticket types preview
         document.getElementById('taxProfile').addEventListener('change', updateTicketTypesPreview);
    }
    
         // Update ticket types preview when selections change
     function updateTicketTypesPreview() {
         const selectedPublicTypes = Array.from(document.querySelectorAll('.public-ticket-type-checkbox:checked'));
         const selectedAgentTypes = Array.from(document.querySelectorAll('.agent-ticket-type-checkbox:checked'));
         const taxProfileId = document.getElementById('taxProfile').value;
         
         if (selectedPublicTypes.length === 0 && selectedAgentTypes.length === 0) {
             document.getElementById('ticketTypesPreview').style.display = 'none';
             return;
         }
         
         // Show individual ticket types by channel
         const publicTypeDetails = selectedPublicTypes.map(checkbox => ({
             price: parseFloat(checkbox.dataset.price),
             currency: checkbox.dataset.currency,
             name: checkbox.dataset.name,
             code: checkbox.dataset.code,
             channel: 'Public'
         }));
         
         const agentTypeDetails = selectedAgentTypes.map(checkbox => ({
             price: parseFloat(checkbox.dataset.price),
             currency: checkbox.dataset.currency,
             name: checkbox.dataset.name,
             code: checkbox.dataset.code,
             channel: 'Agent'
         }));
         
         // Show ticket types preview
         const previewContent = document.getElementById('ticketTypesPreviewContent');
         previewContent.innerHTML = `
             <div class="row">
                 <div class="col-md-8">
                     <strong>Available Ticket Types for This Schedule:</strong>
                     
                     ${publicTypeDetails.length > 0 ? `
                         <div class="mt-2">
                             <span class="badge bg-primary">🌐 Public</span>
                             ${publicTypeDetails.map(type => `
                                 <div class="ticket-type-item">
                                     <span class="badge bg-info me-2">${type.code}</span>
                                     <strong>${type.name}</strong> - 
                                     <span class="badge bg-primary">${type.price} ${type.currency}</span>
                                 </div>
                             `).join('')}
                         </div>
                     ` : ''}
                     
                     ${agentTypeDetails.length > 0 ? `
                         <div class="mt-2">
                             <span class="badge bg-success">👔 Agent</span>
                             ${agentTypeDetails.map(type => `
                                 <div class="ticket-type-item">
                                     <span class="badge bg-info me-2">${type.code}</span>
                                     <strong>${type.name}</strong> - 
                                     <span class="badge bg-primary">${type.price} ${type.currency}</span>
                                 </div>
                             `).join('')}
                         </div>
                     ` : ''}
                     
                     <div class="text-muted small mt-2">
                         <i class="fas fa-info-circle me-1"></i>
                         Customers will see ticket types based on their channel (Public/Agent)
                     </div>
                 </div>
                 <div class="col-md-4">
                     <strong>Tax Profile:</strong>
                     <div>${taxProfileId ? 'Selected' : 'None'}</div>
                     <div class="text-muted small">
                         ${taxProfileId ? 'Taxes will be calculated automatically' : 'No taxes will be applied'}
                     </div>
                 </div>
             </div>
         `;
         
              document.getElementById('ticketTypesPreview').style.display = 'block';
 }

// Load edit mode data from session
function loadEditModeData() {
    // Get data from hidden input fields
    const publicTicketTypeIds = JSON.parse(document.getElementById('publicTicketTypeIds').value);
    const agentTicketTypeIds = JSON.parse(document.getElementById('agentTicketTypeIds').value);
    const taxProfileId = document.getElementById('taxProfileId').value;
    
    // Mark public ticket types as checked
    publicTicketTypeIds.forEach(id => {
        const checkbox = document.querySelector(`input[value="${id}"][data-channel="PUBLIC"]`);
        if (checkbox) {
            checkbox.checked = true;
        }
    });
    
    // Mark agent ticket types as checked
    agentTicketTypeIds.forEach(id => {
        const checkbox = document.querySelector(`input[value="${id}"][data-channel="AGENT"]`);
        if (checkbox) {
            checkbox.checked = true;
        }
    });
    
    // Set tax profile
    if (taxProfileId) {
        document.getElementById('taxProfile').value = taxProfileId;
    }
    
    // Update preview
    updateTicketTypesPreview();
}
});

document.getElementById('scheduleOptionsForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const button = document.querySelector('button[type="submit"]');
    const originalText = button.innerHTML;
    
            // Collect form data
        const selectedPublicTicketTypes = Array.from(document.querySelectorAll('.public-ticket-type-checkbox:checked'));
        const selectedAgentTicketTypes = Array.from(document.querySelectorAll('.agent-ticket-type-checkbox:checked'));
        
        if (selectedPublicTicketTypes.length === 0 && selectedAgentTicketTypes.length === 0) {
            showAlert('Please select at least one ticket type for either public or agent bookings', 'warning');
            return;
        }
        
        const formData = {
            save_as_template: document.getElementById('saveAsTemplate').checked,
            template_name: document.getElementById('templateName').value,
            repeat_schedule: document.getElementById('repeatSchedule').checked,
            selected_dates: document.getElementById('selectedDates').value,
            confirmation_type: document.getElementById('confirmationType').value,
            is_public: document.getElementById('isPublic').checked,
            // New unified pricing fields
            public_ticket_type_ids: selectedPublicTicketTypes.map(cb => parseInt(cb.value)),
            agent_ticket_type_ids: selectedAgentTicketTypes.map(cb => parseInt(cb.value)),
            tax_profile_id: document.getElementById('taxProfile').value || null
        };
    
    showLoading(button);
    
    try {
        const response = await fetch('/schedules/schedule-options', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
            showAlert(data.message, 'success');
            setTimeout(() => {
                window.location.href = data.redirect;
            }, 1500);
        } else {
            showAlert(data.error || 'Failed to {% if edit_mode %}update{% else %}create{% endif %} schedule', 'danger');
        }
    } catch (error) {
        showAlert('Network error. Please try again.', 'danger');
    } finally {
        hideLoading(button, originalText);
    }
});
</script>

<style>
  .mobile-app-container { max-width: 800px; margin: 0 auto; padding: 1rem; }
  .page-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; padding: 1rem; background: #fff; border: 1px solid #e9ecef; border-radius: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
  .header-content { flex: 1; }
  .page-title { margin: 0; font-size: 1.125rem; font-weight: 600; color: #212529; }
  .page-subtitle { margin: 0.25rem 0 0; color: #6c757d; font-size: 0.85rem; }
  .add-btn { width: 40px; height: 40px; background: #f1f3f5; color: #495057; display: inline-flex; align-items: center; justify-content: center; border-radius: 10px; text-decoration: none; }
  .form-card { background: #fff; border: 1px solid #e9ecef; border-radius: 16px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
  .actions { display: flex; justify-content: space-between; gap: 0.75rem; margin-top: 1rem; }
  .submit-btn { border: none; border-radius: 12px; padding: 0.6rem 0.9rem; background: linear-gradient(135deg, #667eea, #764ba2); color: #fff; font-weight: 600; }
  .cancel-link { align-self: center; color: #6c757d; text-decoration: none; }
  .cancel-link:hover { text-decoration: underline; }

/* Calendar Styles */
.calendar-container {
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 1rem;
    background: white;
}

.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid #dee2e6;
}

.calendar-grid {
    width: 100%;
}

.calendar-weekdays {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 2px;
    margin-bottom: 0.5rem;
}

.calendar-weekdays > div {
    text-align: center;
    font-weight: 600;
    font-size: 0.875rem;
    color: #6c757d;
    padding: 0.5rem 0;
}

.calendar-days {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 2px;
}

.calendar-day {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid #dee2e6;
    cursor: pointer;
    font-size: 0.875rem;
    transition: all 0.2s ease;
    background: white;
}

.calendar-day:hover:not(.disabled) {
    background-color: #f8f9fa;
    border-color: #adb5bd;
}

.calendar-day.selected {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.calendar-day.disabled {
    background-color: #f8f9fa;
    color: #adb5bd;
    cursor: not-allowed;
}

.calendar-day.other-month {
    background-color: #f8f9fa;
    color: #adb5bd;
}

.calendar-day.today {
    border-color: var(--primary-color);
    font-weight: 600;
}

/* Ticket Type Preview Styles */
.ticket-type-item {
    padding: 8px 0;
    border-bottom: 1px solid #eee;
}

.ticket-type-item:last-child {
    border-bottom: none;
}

.ticket-type-item .badge {
    font-size: 0.8em;
}
</style>
{% endblock %} 